# LU 分解
## 一、什么是 LU 分解？

### 1. 定义：
LU 分解（LU Decomposition）是将一个 **可逆的方阵 A** 分解为一个 **下三角矩阵 L** 和一个 **上三角矩阵 U 的乘积**：

$$
A = LU
$$

- **L** 是单位下三角矩阵（主对角线元素为1，下方有非零值，上方全为0）
- **U** 是上三角矩阵（主对角线上方有非零值，下方全为0）

---

## 二、为什么要做 LU 分解？

LU 分解的主要用途之一是**高效地求解线性方程组** $Ax = b$ 。因为一旦我们知道 $A = LU$，那么原问题就变成了两个更简单的三角形系统：

1. 解 $ Ly = b $ （前向替换）
2. 解 $ Ux = y $ （后向替换）

这两个过程计算量都比较小，比直接用高斯消元法快很多。

---

## 三、LU 分解的基本思想

LU 分解的核心思想是：**通过高斯消元法把矩阵 A 转换成上三角矩阵 U，并记录每一步操作对应的变换矩阵，从而构造出 L 矩阵。**

---

## 四、LU 分解的具体步骤（以3×3矩阵为例）

我们来看一个具体的例子，假设我们要对以下矩阵进行 LU 分解：

$$
A = \begin{bmatrix}
1 & 2 & 3 \\
4 & 5 & 6 \\
7 & 8 & 9
\end{bmatrix}
$$

目标是找到两个矩阵 L 和 U，使得：

$$
A = LU
$$

其中：

- $ U $ 是上三角矩阵
- $ L $ 是单位下三角矩阵

---

### 步骤1：高斯消元，构造 U

#### 第一步：消去第一列下方的元素

当前矩阵：

$$
\begin{bmatrix}
1 & 2 & 3 \\
4 & 5 & 6 \\
7 & 8 & 9
\end{bmatrix}
$$

目标：把第2行和第3行的第一列变成0。

##### 消去第2行第1列：

我们做行操作：  
$ R_2 = R_2 - 4 \cdot R_1 $

这样做的原因是，因为 $ a_{21} = 4 $，而 $ a_{11} = 1 $，所以倍数是 4。

新矩阵变为：

$$
\begin{bmatrix}
1 & 2 & 3 \\
0 & -3 & -6 \\
7 & 8 & 9
\end{bmatrix}
$$

##### 消去第3行第1列：

行操作：  
$ R_3 = R_3 - 7 \cdot R_1 $

得到：

$$
\begin{bmatrix}
1 & 2 & 3 \\
0 & -3 & -6 \\
0 & -6 & -12
\end{bmatrix}
$$

---

#### 第二步：消去第二列下方的元素

现在看子矩阵：

$$
\begin{bmatrix}
-3 & -6 \\
-6 & -12
\end{bmatrix}
$$

消去第三行第二列的元素：

行操作：  
$ R_3 = R_3 - 2 \cdot R_2 $（因为 $-6 / -3 = 2$）

结果：

$$
\begin{bmatrix}
1 & 2 & 3 \\
0 & -3 & -6 \\
0 & 0 & 0
\end{bmatrix}
= U
$$

---

### 步骤2：构造 L 矩阵

在上面的过程中，我们用了这些行操作来构造 U：

- 第2行减去 4 倍第1行 → 记录 4 在 L 的 (2,1) 位置
- 第3行减去 7 倍第1行 → 记录 7 在 L 的 (3,1) 位置
- 第3行减去 2 倍第2行 → 记录 2 在 L 的 (3,2) 位置

L 是单位下三角矩阵，即主对角线为1：

$$
L = \begin{bmatrix}
1 & 0 & 0 \\
4 & 1 & 0 \\
7 & 2 & 1
\end{bmatrix}
$$

---

### 最终结果：

$$
A = LU = 
\begin{bmatrix}
1 & 0 & 0 \\
4 & 1 & 0 \\
7 & 2 & 1
\end{bmatrix}
\cdot
\begin{bmatrix}
1 & 2 & 3 \\
0 & -3 & -6 \\
0 & 0 & 0
\end{bmatrix}
$$

验证一下是否成立？你可以手动相乘看看是否等于原始矩阵 A。

---

## 五、特殊情况与注意事项

### 1. **需要选主元的情况（PA = LU）**
有时候会出现除数为0或很小的情况，导致数值不稳定。这时我们会使用**部分选主元**（Partial Pivoting），引入一个排列矩阵 P，使得：

$$
PA = LU
$$

P 是一个置换矩阵，表示行交换。

### 2. **不是所有矩阵都能 LU 分解**
只有当矩阵的所有顺序主子式都不为零时，才存在唯一的 LU 分解。否则可能需要选主元。

---

## 六、LU 分解的应用

1. **快速解线性方程组 $ Ax = b $**
   - 先做 LU 分解
   - 解 $ Ly = b $（前向替换）
   - 解 $ Ux = y $（后向替换）

2. **求矩阵的逆**
   - 利用 LU 分解可以更快地求逆矩阵

3. **行列式的计算**
   - 行列式 $ |A| = |L||U| $，由于 L 是单位下三角，其行列式为1，所以 $ |A| = |U| $，而 U 是上三角，行列式就是主对角线元素的乘积。

---

## 七、总结

| 内容 | 说明 |
|------|------|
| 目标 | 将矩阵 A 分解为 L 和 U 的乘积 |
| 方法 | 使用高斯消元法，记录每一步操作 |
| L 矩阵 | 单位下三角矩阵，记录消元过程中的系数 |
| U 矩阵 | 上三角矩阵，是高斯消元后的结果 |
| 注意 | 有时需要选主元（PA=LU）来保证稳定性 |

---

如果你希望我帮你用 Python 实现 LU 分解，或者想练习几个例题，也可以告诉我，我可以继续帮助你！

当然可以！你上传的文件是关于**线性方程组求解的直接方法（Direct Method）**，尤其是 **LU分解（LU Decomposition）** 的讲解。这份材料主要从数值计算的角度出发，重点在于如何用高效、稳定的方法来解决形如：

$$
Ax = b
$$

的线性方程组问题。

我们将从最基础的线性代数知识讲起，逐步深入 LU 分解的原理和实现，并通过例子帮助你理解和记忆。

---

## 🧮 一、基本概念回顾：线性方程组 Ax = b

### 1.1 线性方程组的形式

一个线性方程组通常写成如下形式：

$$
\begin{cases}
a_{11}x_1 + a_{12}x_2 + \cdots + a_{1n}x_n = b_1 \\
a_{21}x_1 + a_{22}x_2 + \cdots + a_{2n}x_n = b_2 \\
\vdots \\
a_{n1}x_1 + a_{n2}x_2 + \cdots + a_{nn}x_n = b_n
\end{cases}
$$

这可以写成矩阵形式：

$$
A x = b
$$

其中：
- $ A \in \mathbb{R}^{n \times n} $ 是系数矩阵（已知）
- $ x \in \mathbb{R}^n $ 是未知向量（待求）
- $ b \in \mathbb{R}^n $ 是常数项（已知）

---

## 🔍 二、直接法 vs 迭代法

文档中提到了两种解法：

| 方法类型 | 名称 | 特点 |
|--------|------|------|
| 直接法 | LU分解、Cholesky分解等 | 精确、稳定，适合中小规模问题 |
| 迭代法 | 雅可比迭代、共轭梯度法等 | 节省内存，适合大规模稀疏问题 |

我们重点学习的是**直接法中的 LU 分解**。

---

## 🧱 三、LU 分解是什么？

### 3.1 定义

LU 分解是指将一个矩阵 $ A $ 分解为两个三角矩阵的乘积：

$$
A = L U
$$

其中：
- $ L $ 是下三角矩阵（Lower Triangular），对角线元素为 1
- $ U $ 是上三角矩阵（Upper Triangular）

> ⚠️ 注意：LU 分解并不总是存在，但在很多实际应用中可以通过**选主元（pivoting）** 来保证其存在性。

---

### 3.2 为什么有用？

因为一旦我们有：

$$
A = LU
$$

那么原方程 $ Ax = b $ 可以变成：

$$
LUx = b
$$

令 $ Ux = z $，则：

1. 先解 $ Lz = b $（前向替换 Forward Substitution）
2. 再解 $ Ux = z $（后向替换 Backward Substitution）

这两个过程都非常快，复杂度是 $ O(n^2) $

---

## 📐 四、三角矩阵的求解方法

### 4.1 前向替换（Forward Substitution）

用于解下三角系统 $ Lz = b $

例如：

$$
\begin{bmatrix}
l_{11} & 0 & 0 \\
l_{21} & l_{22} & 0 \\
l_{31} & l_{32} & l_{33}
\end{bmatrix}
\begin{bmatrix}
z_1 \\ z_2 \\ z_3
\end{bmatrix}
=
\begin{bmatrix}
b_1 \\ b_2 \\ b_3
\end{bmatrix}
$$

逐行解出 $ z_i $：

$$
\begin{aligned}
z_1 &= \frac{b_1}{l_{11}} \\
z_2 &= \frac{b_2 - l_{21}z_1}{l_{22}} \\
z_3 &= \frac{b_3 - l_{31}z_1 - l_{32}z_2}{l_{33}}
\end{aligned}
$$

### ✅ 代码示例（MATLAB风格）：

```matlab
function z = forward_sub(L, b)
    n = length(b);
    z = zeros(n, 1);
    for i = 1:n
        z(i) = (b(i) - L(i, 1:i-1)' * z(1:i-1)) / L(i,i);
    end
end
```

---

### 4.2 后向替换（Backward Substitution）

用于解上三角系统 $ Ux = z $

例如：

$$
\begin{bmatrix}
u_{11} & u_{12} & u_{13} \\
0 & u_{22} & u_{23} \\
0 & 0 & u_{33}
\end{bmatrix}
\begin{bmatrix}
x_1 \\ x_2 \\ x_3
\end{bmatrix}
=
\begin{bmatrix}
z_1 \\ z_2 \\ z_3
\end{bmatrix}
$$

从最后一行开始解：

$$
\begin{aligned}
x_3 &= \frac{z_3}{u_{33}} \\
x_2 &= \frac{z_2 - u_{23}x_3}{u_{22}} \\
x_1 &= \frac{z_1 - u_{12}x_2 - u_{13}x_3}{u_{11}}
\end{aligned}
$$

### ✅ 代码示例（MATLAB风格）：

```matlab
function x = backward_sub(U, z)
    n = length(z);
    x = zeros(n, 1);
    for i = n:-1:1
        x(i) = (z(i) - U(i, i+1:n) * x(i+1:n)) / U(i,i);
    end
end
```

---

## 🧩 五、LU 分解的构造方法

### 5.1 高斯消去法（Gaussian Elimination）

这是构造 LU 分解的核心思想。目标是通过一系列**初等变换矩阵（Gauss Transformations）** 将 $ A $ 化为上三角矩阵 $ U $，然后记录这些变换得到 $ L $。

#### 示例：构造 U

假设我们要对矩阵：

$$
A = 
\begin{bmatrix}
2 & 1 & 1 \\
4 & 3 & 3 \\
6 & 7 & 8
\end{bmatrix}
$$

进行 LU 分解。

步骤：

1. 消除第1列下方的元素：
   - 第2行减去 $ \frac{4}{2} = 2 $ 倍第1行
   - 第3行减去 $ \frac{6}{2} = 3 $ 倍第1行

结果：

$$
\begin{bmatrix}
2 & 1 & 1 \\
0 & 1 & 1 \\
0 & 4 & 5
\end{bmatrix}
$$

2. 消除第2列下方的元素：
   - 第3行减去 $ \frac{4}{1} = 4 $ 倍第2行

结果：

$$
U =
\begin{bmatrix}
2 & 1 & 1 \\
0 & 1 & 1 \\
0 & 0 & 1
\end{bmatrix}
$$

此时记录每一步的操作，就得到了 $ L $：

$$
L =
\begin{bmatrix}
1 & 0 & 0 \\
2 & 1 & 0 \\
3 & 4 & 1
\end{bmatrix}
$$

验证：

$$
LU = 
\begin{bmatrix}
1 & 0 & 0 \\
2 & 1 & 0 \\
3 & 4 & 1
\end{bmatrix}
\cdot
\begin{bmatrix}
2 & 1 & 1 \\
0 & 1 & 1 \\
0 & 0 & 1
\end{bmatrix}
=
\begin{bmatrix}
2 & 1 & 1 \\
4 & 3 & 3 \\
6 & 7 & 8
\end{bmatrix}
= A
$$

✅ 成功！

---

## 📌 六、LU 分解的应用

### 6.1 解线性方程组 Ax = b

步骤：
1. 对 $ A $ 进行 LU 分解：$ A = LU $
2. 解 $ Lz = b $ 得到 $ z $
3. 解 $ Ux = z $ 得到 $ x $

### 6.2 计算逆矩阵 A⁻¹

若 $ AB = I $，即 $ B = A^{-1} $，则每一列 $ b_i $ 满足 $ Ab_i = e_i $，可以分别解每个方程。

### 6.3 计算行列式 det(A)

由于：

$$
\det(A) = \det(L)\det(U) = \prod_{i=1}^n u_{ii}
$$

因为 $ L $ 的对角线都是 1，所以只需取 $ U $ 的对角线乘积即可。

---

## ⚠️ 七、稳定性与选主元（Pivoting）

在实际中，如果某个主元（pivot）接近于零，会导致误差放大，甚至数值不稳定。

为此，引入了 **部分选主元（Partial Pivoting）** 和 **完全选主元（Complete Pivoting）**

### 7.1 部分选主元（GEPP）

每次选择当前列中绝对值最大的元素作为主元，交换行。

### 7.2 完全选主元（GECP）

不仅换行，还换列，使得选取整个子矩阵中最大元素为主元。

---

## 📈 八、条件数（Condition Number）

### 8.1 定义

$$
\kappa(A) = \|A\| \cdot \|A^{-1}\|
$$

表示矩阵的“敏感程度”。越大越容易受扰动影响。

### 8.2 不同范数下的条件数

- $ \kappa_2(A) = \frac{\sigma_1}{\sigma_n} $ （奇异值的最大/最小比）
- $ \kappa_1(A), \kappa_\infty(A) $ 也类似定义

> 💡 举例：即使矩阵的行列式非常小，也可能不是病态的；反之亦然。

---

## 🧪 九、实例练习题（期末考试推荐）

### 题目1：LU 分解

给定矩阵：

$$
A = 
\begin{bmatrix}
1 & 2 & 3 \\
2 & 5 & 7 \\
3 & 6 & 9
\end{bmatrix}
$$

要求：
1. 进行 LU 分解（不使用选主元）
2. 验证是否满足 $ LU = A $

---

### 题目2：解方程组

已知：

$$
A = 
\begin{bmatrix}
2 & 1 \\
4 & 3
\end{bmatrix}, \quad
b = 
\begin{bmatrix}
5 \\ 11
\end{bmatrix}
$$

要求：
1. 对 A 进行 LU 分解
2. 使用前向和后向替换求解 $ x $

---

### 题目3：计算条件数

设：

$$
A = 
\begin{bmatrix}
1 & 0.99 \\
1 & 1
\end{bmatrix}
$$

求 $ \kappa_1(A) $

---

如果你希望我详细写出这些题目的完整解答，请告诉我！我可以为你一步步推导并解释。

---

## ✅ 总结

| 主题 | 关键内容 |
|------|----------|
| 线性方程组 | $ Ax = b $，核心问题是求解 x |
| LU 分解 | $ A = LU $，L 下三角，U 上三角 |
| 前向/后向替换 | 快速解三角系统，复杂度 $ O(n^2) $ |
| 高斯消去法 | 构造 LU 分解的基础算法 |
| 选主元 | 提高数值稳定性，避免除以接近零的主元 |
| 条件数 | 衡量矩阵的“病态”程度，决定解的稳定性 |

---

如果你需要我帮你整理一份**复习笔记**或**公式总结表**，也可以告诉我！

祝你考试顺利！💪📚